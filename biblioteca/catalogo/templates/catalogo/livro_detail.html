{% extends 'base.html' %}

{% block title %}{{ livro.titulo }} - Biblioteca Online{% endblock %}

{% block content %}
<div class="card">
    <div style="display: grid; grid-template-columns: 300px 1fr; gap: 2rem;">
        <div>
            {% if livro.capa %}
                <img src="{{ livro.capa.url }}" alt="{{ livro.titulo }}" style="width: 100%; border-radius: 8px;">
            {% else %}
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='400'%3E%3Crect fill='%23ddd' width='300' height='400'/%3E%3Ctext fill='%23999' x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' font-size='24'%3ESem Capa%3C/text%3E%3C/svg%3E" alt="Sem capa" style="width: 100%; border-radius: 8px;">
            {% endif %}

            <span class="badge {% if livro.disponibilidade %}disponivel{% else %}indisponivel{% endif %}" style="display: block; text-align: center; margin-top: 1rem;">
                {% if livro.disponibilidade %}Disponível{% else %}Emprestado{% endif %}
            </span>
        </div>

        <div>
            <h2>{{ livro.titulo }}</h2>
            <p><strong>Autor:</strong> {{ livro.autor.nome }}</p>
            <p><strong>Categoria:</strong> {{ livro.get_categoria_display }}</p>
            <p><strong>Editora:</strong> {{ livro.editora }}</p>
            <p><strong>Ano de Publicação:</strong> {{ livro.ano_publicacao }}</p>
            <p><strong>ISBN:</strong> {{ livro.isbn }}</p>

            {% if livro.sinopse %}
                <h3 style="margin-top: 1.5rem;">Sinopse</h3>
                <p>{{ livro.sinopse }}</p>
            {% endif %}

            {% if livro.autor.bio %}
                <h3 style="margin-top: 1.5rem;">Sobre o Autor</h3>
                <p>{{ livro.autor.bio }}</p>
            {% endif %}

            <div class="btn-group" style="margin-top: 2rem;">
                <a href="{% url 'catalogo:livros_list' %}" class="btn btn-secondary">Voltar</a>

                {% if livro.disponibilidade %}
                    <a href="{% url 'catalogo:emprestimo_create' %}?livro={{ livro.pk }}" class="btn btn-success">Emprestar</a>
                {% endif %}

                {% if is_bibliotecario or user.is_superuser %}
                    <a href="{% url 'catalogo:livro_edit' livro.pk %}" class="btn btn-primary">Editar</a>
                    <a href="{% url 'catalogo:livro_delete' livro.pk %}" class="btn btn-danger">Excluir</a>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
